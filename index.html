<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Project 45 – Study Material</title>

<!-- Tailwind CDN -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<style>
:root {
  --bg1: #041024;
  --bg2: #071226;
  --glass: rgba(255,255,255,0.06);
  --accent: #10b981;
  --card-bg: rgba(255,255,255,0.05);
}

body {
  background: linear-gradient(180deg, var(--bg1), var(--bg2));
}

/* Banner */
.banner-slide {
  width: 100%;
  height: 180px;
  object-fit: cover;
  border-radius: 16px;
  box-shadow: 0 6px 20px rgba(0,0,0,0.5);
}

/* Glass Cards */
.card {
  background: var(--card-bg);
  border-radius: 16px;
  box-shadow: 0 20px 50px rgba(3, 6, 12, 0.6);
  overflow: hidden;
  border: 1px solid var(--glass);
  transition: .3s;
}
.card:hover {
  transform: translateY(-8px);
  border-color: rgba(16,185,129,0.4);
}

.poster {
  width: 100%;
  height: 160px;
  object-fit: cover;
}

/* Tab Buttons */
.tab-btn {
  border-radius: 10px;
  padding: 8px 16px;
  background: linear-gradient(90deg, #0ea5a4, #10b981);
  color: #071226;
  font-weight: 600;
}
.tab-btn:hover {
  opacity: .9;
  transform: translateY(-2px);
}

/* Links */
.open-link {
  display: inline-block;
  padding: 8px 12px;
  margin-top: 10px;
  background: linear-gradient(90deg, #0ea5a4, #10b981);
  color: #071226;
  border-radius: 10px;
  font-weight: 600;
}
</style>
</head>

<body class="text-white">

<!-- HEADER -->
<header class="p-4 text-center text-3xl font-bold text-emerald-400">
  Project 45 – Study Resources
</header>

<!-- BANNERS -->
<div id="banner-area" class="p-4 space-y-4"></div>

<!-- CATEGORY SELECTOR -->
<div class="p-4">
  <label class="text-gray-300 text-lg">Select Category:</label>
  <select id="category-filter" class="w-full p-3 rounded bg-[#0d1a33] border border-[#1a2747] text-white mt-2"></select>
</div>

<!-- TABS -->
<div class="flex justify-center gap-4 my-4">
  <button class="tab-btn" onclick="showSection('projects')">Projects</button>
  <button class="tab-btn" onclick="showSection('notes')">Notes</button>
  <button class="tab-btn" onclick="showSection('dpp')">DPP</button>
</div>

<!-- CONTENT -->
<div class="p-4">

  <!-- PROJECTS -->
  <div id="projects-section" class="section">
    <h2 class="text-xl font-bold mb-4">Projects</h2>
    <div id="projects-list" class="grid grid-cols-2 gap-4"></div>
  </div>

  <!-- NOTES -->
  <div id="notes-section" class="section hidden">
    <h2 class="text-xl font-bold mb-4">Notes</h2>
    <div id="notes-list" class="grid grid-cols-2 gap-4"></div>
  </div>

  <!-- DPP -->
  <div id="dpp-section" class="section hidden">
    <h2 class="text-xl font-bold mb-4">Daily Practice Papers</h2>
    <div id="dpp-list" class="grid grid-cols-2 gap-4"></div>
  </div>

</div>

<script>
// ---------------- FIREBASE ----------------
const firebaseConfig = {
  apiKey: "AIzaSyA8Ck4k7gMfn9oU1nq-JBijML1JE6yVx84",
  authDomain: "project45-627cc.firebaseapp.com",
  databaseURL: "https://project45-627cc-default-rtdb.firebaseio.com",
  projectId: "project45-627cc",
  storageBucket: "project45-627cc.appspot.com",
  messagingSenderId: "850515567224",
  appId: "1:850515567224:web:bcbed252ee8596c08fc38d"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let allCategories = {};
let allProjects = {};
let allNotes = {};
let allDpp = {};

// ---------------- SECTIONS ----------------
function showSection(sec) {
  document.querySelectorAll(".section").forEach(s => s.classList.add("hidden"));
  document.getElementById(sec + "-section").classList.remove("hidden");
}

// ---------------- BANNERS ----------------
function loadBanners() {
  const area = document.getElementById("banner-area");
  area.innerHTML = "";

  db.ref("banners").once("value").then(snap => {
    snap.forEach(child => {
      const url = child.val().url;
      area.innerHTML += `<img src="${url}" class="banner-slide">`;
    });
  });
}

// ---------------- CATEGORY DROPDOWN ----------------
function loadCategories() {
  const select = document.getElementById("category-filter");
  select.innerHTML = `<option value="">All Categories</option>`;

  db.ref("categories").once("value").then(snap => {
    snap.forEach(child => {
      const name = child.val().name;
      allCategories[child.key] = name;
      select.innerHTML += `<option value="${name}">${name}</option>`;
    });

    renderAll();
  });

  select.addEventListener("change", renderAll);
}

// ---------------- PROJECTS ----------------
function renderProjects() {
  const list = document.getElementById("projects-list");
  list.innerHTML = "";

  const filter = document.getElementById("category-filter").value;

  Object.entries(allProjects).forEach(([id, p]) => {
    if (filter && p.category !== filter) return;

    list.innerHTML += `
      <div class="card">
        <img src="${p.poster}" class="poster">
        <div class="p-3">
          <p class="font-bold">${p.title}</p>
          <p class="text-gray-400 text-sm">${p.year}</p>
          <a href="${p.link}" target="_blank" class="open-link">Open</a>
        </div>
      </div>
    `;
  });
}

// ---------------- NOTES ----------------
function renderNotes() {
  const list = document.getElementById("notes-list");
  list.innerHTML = "";

  const filter = document.getElementById("category-filter").value;

  Object.entries(allNotes).forEach(([id, n]) => {
    if (filter && n.category !== filter) return;

    list.innerHTML += `
      <div class="card p-3">
        <p class="font-bold">${n.title}</p>
        <a href="${n.link}" target="_blank" class="open-link">Open Notes</a>
      </div>
    `;
  });
}

// ---------------- DPP ----------------
function renderDpp() {
  const list = document.getElementById("dpp-list");
  list.innerHTML = "";

  const filter = document.getElementById("category-filter").value;

  Object.entries(allDpp).forEach(([id, d]) => {
    if (filter && d.category !== filter) return;

    list.innerHTML += `
      <div class="card p-3">
        <p class="font-bold">${d.title}</p>
        <a href="${d.link}" target="_blank" class="open-link">Open DPP</a>
      </div>
    `;
  });
}

// ---------------- LIVE DATA ----------------
function startLive() {
  db.ref("projects").on("value", snap => {
    allProjects = snap.val() || {};
    renderProjects();
  });

  db.ref("notes").on("value", snap => {
    allNotes = snap.val() || {};
    renderNotes();
  });

  db.ref("dpp").on("value", snap => {
    allDpp = snap.val() || {};
    renderDpp();
  });
}

// ---------------- RENDER ALL ----------------
function renderAll() {
  renderProjects();
  renderNotes();
  renderDpp();
}

// ---------------- INIT ----------------
loadBanners();
loadCategories();
startLive();

</script>

</body>
</html>
